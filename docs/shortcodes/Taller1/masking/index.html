<!doctype html><html lang=en-us dir=ltr><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="Masking # Kernels # Un kernel, matriz de convolución o máscara es una pequeña matriz que se utiliza en el procesamiento de imágenes para desenfocar, enfocar, resaltar, detectar bordes, etc. Para ello se utiliza la convolución entre el núcleo y una imagen.
Dado que es posible aplicar efectos como el desenfoque, la nitidez, el relieve, la detección de bordes, etc., mediante una operación de convolución entre el núcleo (matriz) y la imagen, el enmascaramiento es crucial en el ámbito del procesamiento de imágenes."><meta name=theme-color content="#FFFFFF"><meta name=color-scheme content="light dark"><meta property="og:title" content><meta property="og:description" content="Masking # Kernels # Un kernel, matriz de convolución o máscara es una pequeña matriz que se utiliza en el procesamiento de imágenes para desenfocar, enfocar, resaltar, detectar bordes, etc. Para ello se utiliza la convolución entre el núcleo y una imagen.
Dado que es posible aplicar efectos como el desenfoque, la nitidez, el relieve, la detección de bordes, etc., mediante una operación de convolución entre el núcleo (matriz) y la imagen, el enmascaramiento es crucial en el ámbito del procesamiento de imágenes."><meta property="og:type" content="article"><meta property="og:url" content="https://imgamp.github.io/visualcomputing.github.io/docs/shortcodes/Taller1/masking/"><meta property="article:section" content="docs"><meta property="article:modified_time" content="2022-09-14T11:51:48-05:00"><title>Masking | Visual Computing</title><link rel=manifest href=/visualcomputing.github.io/manifest.json><link rel=icon href=/visualcomputing.github.io/favicon.png type=image/x-icon><link rel=stylesheet href=/visualcomputing.github.io/book.min.ab46de3e725a6415339a37bba23a0067534a37289b063c9f8d011515a63097a8.css integrity="sha256-q0bePnJaZBUzmje7ojoAZ1NKNyibBjyfjQEVFaYwl6g=" crossorigin=anonymous><script defer src=/visualcomputing.github.io/flexsearch.min.js></script>
<script defer src=/visualcomputing.github.io/en.search.min.0ccee159592934094471eef35deb79e1b09d825b65607e0441ee162087009607.js integrity="sha256-DM7hWVkpNAlEce7zXet54bCdgltlYH4EQe4WIIcAlgc=" crossorigin=anonymous></script></head><body dir=ltr><input type=checkbox class="hidden toggle" id=menu-control>
<input type=checkbox class="hidden toggle" id=toc-control><main class="container flex"><aside class=book-menu><div class=book-menu-content><nav><h2 class=book-brand><a class="flex align-center" href=/visualcomputing.github.io/><span>Visual Computing</span></a></h2><div class=book-search><input type=text id=book-search-input placeholder=Search aria-label=Search maxlength=64 data-hotkeys=s/><div class="book-search-spinner hidden"></div><ul id=book-search-results></ul></div><ul><li class=book-section-flat><span>Shortcodes</span><ul><li><a href=/visualcomputing.github.io/docs/shortcodes/integrantes/>Integrantes</a></li><li><input type=checkbox id=section-c04a898dd5a4aeb4a8e570b60dd467fe class=toggle checked>
<label for=section-c04a898dd5a4aeb4a8e570b60dd467fe class="flex justify-between"><a href=/visualcomputing.github.io/docs/shortcodes/Taller1/>Taller1</a></label><ul><li><a href=/visualcomputing.github.io/docs/shortcodes/Taller1/ilusiones/>Ilusiones</a></li><li><a href=/visualcomputing.github.io/docs/shortcodes/Taller1/masking/ class=active>Masking</a></li></ul></li></ul></li></ul><ul><li><a href=/visualcomputing.github.io/posts/>Blog</a></li></ul></nav><script>(function(){var e=document.querySelector("aside .book-menu-content");addEventListener("beforeunload",function(){localStorage.setItem("menu.scrollTop",e.scrollTop)}),e.scrollTop=localStorage.getItem("menu.scrollTop")})()</script></div></aside><div class=book-page><header class=book-header><div class="flex align-center justify-between"><label for=menu-control><img src=/visualcomputing.github.io/svg/menu.svg class=book-icon alt=Menu></label>
<strong>Masking</strong>
<label for=toc-control><img src=/visualcomputing.github.io/svg/toc.svg class=book-icon alt="Table of Contents"></label></div><aside class="hidden clearfix"><nav id=TableOfContents><ul><li><a href=#masking>Masking</a><ul><li><a href=#kernels>Kernels</a><ul><li><a href=#codigo>Codigo</a></li><li><a href=#discusión>Discusión</a></li></ul></li></ul></li></ul></nav></aside></header><article class=markdown><h1 id=masking>Masking
<a class=anchor href=#masking>#</a></h1><h2 id=kernels>Kernels
<a class=anchor href=#kernels>#</a></h2><p>Un kernel, matriz de convolución o máscara es una pequeña matriz que se utiliza en el procesamiento de imágenes para desenfocar, enfocar, resaltar, detectar bordes, etc. Para ello se utiliza la convolución entre el núcleo y una imagen.</p><p>Dado que es posible aplicar efectos como el desenfoque, la nitidez, el relieve, la detección de bordes, etc., mediante una operación de convolución entre el núcleo (matriz) y la imagen, el enmascaramiento es crucial en el ámbito del procesamiento de imágenes. En vista de ello, el objetivo de este estudio es evaluar el proceso de convolución de imágenes de forma que se haga un recorrido por cada una de las ideas que lo explican para obtener una perspectiva amplia.</p><h3 id=codigo>Codigo
<a class=anchor href=#codigo>#</a></h3><details><summary>Código en p5.js</summary><div class=markdown-inner><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style=display:flex><span><span style=color:#66d9ef>function</span> <span style=color:#a6e22e>convolution</span>(<span style=color:#a6e22e>x</span>, <span style=color:#a6e22e>y</span>, <span style=color:#a6e22e>matrix</span>, <span style=color:#a6e22e>matrixsize</span>, <span style=color:#a6e22e>img</span>) {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>rtotal</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0.0</span>;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>gtotal</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0.0</span>;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>btotal</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0.0</span>;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>offset</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>floor</span>(<span style=color:#a6e22e>matrixsize</span> <span style=color:#f92672>/</span> <span style=color:#ae81ff>2</span>);
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>let</span> <span style=color:#a6e22e>i</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>; <span style=color:#a6e22e>i</span> <span style=color:#f92672>&lt;</span> <span style=color:#a6e22e>matrixsize</span>; <span style=color:#a6e22e>i</span><span style=color:#f92672>++</span>){
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>let</span> <span style=color:#a6e22e>j</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>; <span style=color:#a6e22e>j</span> <span style=color:#f92672>&lt;</span> <span style=color:#a6e22e>matrixsize</span>; <span style=color:#a6e22e>j</span><span style=color:#f92672>++</span>){
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>xloc</span> <span style=color:#f92672>=</span> (<span style=color:#a6e22e>x</span> <span style=color:#f92672>+</span> <span style=color:#a6e22e>i</span> <span style=color:#f92672>-</span> <span style=color:#a6e22e>offset</span>);
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>yloc</span> <span style=color:#f92672>=</span> (<span style=color:#a6e22e>y</span> <span style=color:#f92672>+</span> <span style=color:#a6e22e>j</span> <span style=color:#f92672>-</span> <span style=color:#a6e22e>offset</span>);
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>loc</span> <span style=color:#f92672>=</span> (<span style=color:#a6e22e>xloc</span> <span style=color:#f92672>+</span> <span style=color:#a6e22e>img</span>.<span style=color:#a6e22e>width</span> <span style=color:#f92672>*</span> <span style=color:#a6e22e>yloc</span>) <span style=color:#f92672>*</span> <span style=color:#ae81ff>4</span>;
</span></span><span style=display:flex><span>  
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>loc</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>constrain</span>(<span style=color:#a6e22e>loc</span>, <span style=color:#ae81ff>0</span> , <span style=color:#a6e22e>img</span>.<span style=color:#a6e22e>pixels</span>.<span style=color:#a6e22e>length</span> <span style=color:#f92672>-</span> <span style=color:#ae81ff>1</span>);
</span></span><span style=display:flex><span>  
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>rtotal</span> <span style=color:#f92672>+=</span> (<span style=color:#a6e22e>img</span>.<span style=color:#a6e22e>pixels</span>[<span style=color:#a6e22e>loc</span>]) <span style=color:#f92672>*</span> <span style=color:#a6e22e>matrix</span>[<span style=color:#a6e22e>i</span>][<span style=color:#a6e22e>j</span>];
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>gtotal</span> <span style=color:#f92672>+=</span> (<span style=color:#a6e22e>img</span>.<span style=color:#a6e22e>pixels</span>[<span style=color:#a6e22e>loc</span> <span style=color:#f92672>+</span> <span style=color:#ae81ff>1</span>]) <span style=color:#f92672>*</span> <span style=color:#a6e22e>matrix</span>[<span style=color:#a6e22e>i</span>][<span style=color:#a6e22e>j</span>];
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>btotal</span> <span style=color:#f92672>+=</span> (<span style=color:#a6e22e>img</span>.<span style=color:#a6e22e>pixels</span>[<span style=color:#a6e22e>loc</span> <span style=color:#f92672>+</span> <span style=color:#ae81ff>2</span>]) <span style=color:#f92672>*</span> <span style=color:#a6e22e>matrix</span>[<span style=color:#a6e22e>i</span>][<span style=color:#a6e22e>j</span>];
</span></span><span style=display:flex><span>      }
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>rtotal</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>constrain</span>(<span style=color:#a6e22e>rtotal</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>255</span>);
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>gtotal</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>constrain</span>(<span style=color:#a6e22e>gtotal</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>255</span>);
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>btotal</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>constrain</span>(<span style=color:#a6e22e>btotal</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>255</span>);
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> <span style=color:#a6e22e>color</span>(<span style=color:#a6e22e>rtotal</span>, <span style=color:#a6e22e>gtotal</span>, <span style=color:#a6e22e>btotal</span>);
</span></span><span style=display:flex><span>  };
</span></span></code></pre></div></div></details><iframe id=changesize style=width:660px;height:920px srcdoc="
        <!DOCTYPE html>
        <html>
          <head>
            <script src=https://cdnjs.cloudflare.com/ajax/libs/p5.js/1.4.2/p5.min.js></script>
            <script src=https://cdnjs.cloudflare.com/ajax/libs/p5.js/1.4.2/addons/p5.sound.min.js></script>
            
            
            
            
            
            <script>
              

let img, in1, in2, in3, in4, in5, in6, in7, in8, in9, button;

  const matrix = [ [ 0.0625, 0.125, 0.0625 ],
              [ 0.125, 0.25, 0.125 ],
              [ 0.0625, 0.125, 0.0625 ] ]; 

  preload = function(){
    img = loadImage('flowers2.jpg');
  };

  setup = function () {
    createCanvas(640, 900);

    in1 = createInput();
    in2 = createInput();
    in3 = createInput();
    in4 = createInput();
    in5 = createInput();
    in6 = createInput();
    in7 = createInput();
    in8 = createInput();
    in9 = createInput();
    button = createButton('Apply');
    button.mousePressed(kernel);

    img.loadPixels();
    pixelDensity(1);
    noLoop();
  };

  draw = function () {
    background(230);
    const matrixsize = 3;

    // Histogram
    var maxRange = 256
    var histogram = new Array(maxRange);
    for (i = 0; i <= maxRange; i++) {
      histogram[i] = 0
    }

    loadPixels();
    for (let x = 0; x < img.width; x++) {
      for (let y = 0; y < img.height; y++ ) {
        let c = convolution(x, y, matrix, matrixsize, img);

        let loc = (x + y*img.width) * 4;
        let red = pixels[loc] = red(c);
        let green = pixels[loc + 1] = green(c);
        let blue = pixels[loc + 2] = blue(c);
        let alpha = pixels[loc + 3] = alpha(c);
        let luma = 0.299*red + 0.587*green + 0.114*blue // Convert to grey scale

        b = int(luma);
        histogram[b]++
      }
    }
    updatePixels();

    stroke(0,213,255)
    push()
    translate(10,0)
    for (x = 0; x <= maxRange; x++) {
      index = histogram[x];

      y1=int(map(index, 0, max(histogram), height, height-200));
      y2 = height
      xPos = map(x,0,maxRange,0, width-20)
      line(xPos, y1, xPos, y2);
    }
    pop()
  };

  function convolution(x, y, matrix, matrixsize, img) {
    let rtotal = 0.0;
    let gtotal = 0.0;
    let btotal = 0.0;
    const offset = floor(matrixsize / 2);
    for (let i = 0; i < matrixsize; i++){
      for (let j = 0; j < matrixsize; j++){
        
        const xloc = (x + i - offset);
        const yloc = (y + j - offset);
        let loc = (xloc + img.width * yloc) * 4;
  
        loc = constrain(loc, 0 , img.pixels.length - 1);
  
        rtotal += (img.pixels[loc]) * matrix[i][j];
        gtotal += (img.pixels[loc + 1]) * matrix[i][j];
        btotal += (img.pixels[loc + 2]) * matrix[i][j];
      }
    }
    rtotal = constrain(rtotal, 0, 255);
    gtotal = constrain(gtotal, 0, 255);
    btotal = constrain(btotal, 0, 255);
    
    return color(rtotal, gtotal, btotal);
  };

  function kernel(){
    matrix[0][0] = in1.value();
    matrix[0][1] = in2.value();
    matrix[0][2] = in3.value();
    matrix[1][0] = in4.value();
    matrix[1][1] = in5.value();
    matrix[1][2] = in6.value();
    matrix[2][0] = in7.value();
    matrix[2][1] = in8.value();
    matrix[2][2] = in9.value();

    redraw();
  };


            </script>
          </head>
          <body>
          </body>
        </html>
      "></iframe>
<script src=https://cdnjs.cloudflare.com/ajax/libs/p5.js/1.4.2/p5.min.js></script>
<script src=https://cdnjs.cloudflare.com/ajax/libs/p5.js/1.4.2/addons/p5.sound.min.js></script>
<script src=visualcomputing.github.io/content/sketches/workshopEj1.js></script><div id=workshopEj1></div><h3 id=discusión>Discusión
<a class=anchor href=#discusi%c3%b3n>#</a></h3><p>El programa permite introducir los valores del núcleo y luego hacer clic en el botón Aplicar para aplicar la operación. Un ejercicio sencillo pero ilustrativo sería poner a cero todos los valores de la matriz, pero para aplicar un efecto de luminosidad variable, sería el del medio el que se podría variar, digamos, de 0 a 2 en pasos de 0 a 1, sólo el valor de Oscurece o agranda la imagen.</p><p>Así, podemos ver que la convolución es una operación matemática utilizada en diversos campos de investigación (como el de las señales y las comunicaciones), y en el procesamiento de imágenes juega un papel importante en diversas implementaciones de aplicaciones de filtros, reconocimiento de caras, etc. .</p></article><footer class=book-footer><div class="flex flex-wrap justify-between"><div><a class="flex align-center" href=https://github.com/ImGAMP/visualcomputing.showcase/commit/014f8fbe816bf0c60660ad7abe3dfc5af7f911a9 title='Last modified by Gustavo Mojica | Agosto 98, 141414' target=_blank rel=noopener><img src=/visualcomputing.github.io/svg/calendar.svg class=book-icon alt=Calendar>
<span>Agosto 98, 141414</span></a></div></div><script>(function(){function e(e){const t=window.getSelection(),n=document.createRange();n.selectNodeContents(e),t.removeAllRanges(),t.addRange(n)}document.querySelectorAll("pre code").forEach(t=>{t.addEventListener("click",function(){e(t.parentElement),navigator.clipboard&&navigator.clipboard.writeText(t.parentElement.textContent)})})})()</script></footer><div class=book-comments></div><label for=menu-control class="hidden book-menu-overlay"></label></div><aside class=book-toc><div class=book-toc-content><nav id=TableOfContents><ul><li><a href=#masking>Masking</a><ul><li><a href=#kernels>Kernels</a><ul><li><a href=#codigo>Codigo</a></li><li><a href=#discusión>Discusión</a></li></ul></li></ul></li></ul></nav></div></aside></main></body></html>